<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>취득세 계산기</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .acq-tax-container { max-width: 700px; margin: 40px auto; background: #fff; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.07); padding: 32px 28px; }
        .acq-tax-title { font-size: 1.6em; font-weight: bold; margin-bottom: 24px; color: #17506b; text-align:center; }
        .acq-tax-form label { font-weight: 500; margin-bottom: 6px; display:block; }
        .acq-tax-form input, .acq-tax-form select { width: 100%; padding: 10px; margin-bottom: 18px; border-radius: 5px; border: 1px solid #ccc; font-size: 15px; }
        .acq-tax-form button { width: 100%; background: #17506b; color: #fff; border: none; border-radius: 5px; padding: 13px; font-size: 17px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .acq-tax-form button:hover { background: #003366; }
        .result-box { background: #f8f9fa; border-radius: 6px; padding: 18px; margin-top: 18px; font-size: 1.1em; color: #0b4e7b; text-align:center; }
        .top-bar { display:flex; justify-content:flex-end; margin-bottom:18px; }
        .main-btn { background:#003366; color:#fff; border:none; border-radius:5px; padding:8px 18px; font-size:15px; font-weight:600; cursor:pointer; }
        .main-btn:hover { background:#17506b; }
    </style>
</head>
<body>
    <div class="acq-tax-container">
        <div class="top-bar">
            <a href="{{ url_for('main') }}" class="main-btn">메인으로</a>
        </div>
        <div class="acq-tax-title">취득세 계산기</div>
        <form class="acq-tax-form" id="acqTaxForm" onsubmit="return false;">
            <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
                <label style="margin-bottom:0;">취득물건종류</label>
                <button type="button" id="showTaxRateBtn" style="background:#208e4c;color:#fff;font-weight:600;padding:6px 18px;border-radius:6px;border:none;">취득세율 보기</button>
            </div>
            <div style="display:flex;gap:30px;align-items:center;justify-content:center;margin-bottom:18px;">
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="itemType" value="주택" checked style="margin-right:6px;"> 주택</label>
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="itemType" value="건축물" style="margin-right:6px;"> 건축물</label>
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="itemType" value="토지" style="margin-right:6px;"> 토지</label>
            </div>
            <div style="display:flex;align-items:center;gap:30px;margin-bottom:10px;">
                <label style="margin-bottom:0;">취득구분</label>
            </div>
            <div style="display:flex;gap:30px;align-items:center;justify-content:center;margin-bottom:18px;">
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="acqType" value="매매" checked style="margin-right:6px;"> 매매</label>
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="acqType" value="신축" style="margin-right:6px;"> 신축</label>
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="acqType" value="증여" style="margin-right:6px;"> 증여</label>
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="acqType" value="상속" style="margin-right:6px;"> 상속</label>
            </div>
            <div style="display:flex;align-items:center;gap:30px;margin-bottom:10px;">
                <label style="margin-bottom:0;">주택보유수</label>
            </div>
            <div style="display:flex;align-items:center;justify-content:center;margin-bottom:18px;">
                <select id="houseCount" style="width:auto;min-width:320px;">
                    <option value="1">조정 1주택 / 비조정 2주택 / 비조정 1주택</option>
                    <option value="2">조정 2주택 / 비조정 3주택</option>
                    <option value="3">조정 3주택 이상 / 비조정 4주택 이상</option>
                </select>
            </div>
            <div style="display:flex;align-items:center;gap:30px;margin-bottom:10px;">
                <label style="margin-bottom:0;">85제곱 초과 여부</label>
            </div>
            <div style="display:flex;gap:30px;align-items:center;justify-content:center;margin-bottom:18px;">
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="over85" value="yes" style="margin-right:6px;"> 예</label>
                <label style="font-weight:400;display:flex;align-items:center;"><input type="radio" name="over85" value="no" checked style="margin-right:6px;"> 아니오</label>
            </div>
            <label>취득가액(원)</label>
            <input type="text" id="acqPrice" required pattern="[0-9,]*" placeholder="예: 300,000,000">
            <label>공시지가(원)</label>
            <input type="text" id="officialPrice" required pattern="[0-9,]*" placeholder="예: 250,000,000">
            <button type="submit">계산</button>
        </form>

        <!-- 취득세율 안내 모달 -->
        <div id="taxRateModal" style="display:none;position:fixed;z-index:1000;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.35);">
            <div style="background:#fff;max-width:700px;margin:60px auto;padding:32px 28px;border-radius:10px;position:relative;">
                <button id="closeTaxRateModal" style="position:absolute;top:18px;right:18px;font-size:1.5em;background:none;border:none;cursor:pointer;">×</button>
                <h3 style="color:#17506b;">취득세율/농특세/교육세 안내</h3>
                <table style="width:100%;border-collapse:collapse;text-align:center;">
                    <thead><tr style="background:#2980b9;color:#fff;"><th>구분</th><th>취득세</th><th>농특세</th><th>교육세</th></tr></thead>
                    <tbody>
                        <tr><td>주택(1주택)</td><td>1%</td><td>-</td><td>-</td></tr>
                        <tr><td>주택(2주택)</td><td>2%</td><td>-</td><td>-</td></tr>
                        <tr><td>주택(3주택 이상)</td><td>3%</td><td>0.2%</td><td>-</td></tr>
                        <tr><td>건축물/토지</td><td>4%</td><td>0.2%</td><td>0.4%</td></tr>
                    </tbody>
                </table>
                <div style="font-size:0.95em;color:#888;margin-top:10px;">실제 세율은 지역, 금액, 조건에 따라 다를 수 있습니다.</div>
            </div>
        </div>
        <div class="result-box" id="resultBox" style="display:none;"></div>
    </div>
    <script>
    // 3자리 콤마
    function addComma(num) {
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    function removeComma(str) {
        return str.replace(/,/g, '');
    }
    // 입력란 콤마 자동
    ['acqPrice','officialPrice'].forEach(id => {
        const el = document.getElementById(id);
        el.addEventListener('input', function(e) {
            let val = removeComma(this.value);
            if (val) this.value = addComma(Number(val));
        });
    });
    // 단순 예시: 주택/건축물/토지별 기본 취득세율/농특세/교육세율 적용
    function getTaxRates(itemType, acqType, houseCount, over85) {
        // 실제 세율은 복잡하므로 예시(주택: 1~3%, 건축물/토지: 4%)
        if(itemType==='주택') {
            if(houseCount==='1') return {tax:0.01, nt:0, edu:0};
            if(houseCount==='2') return {tax:0.02, nt:0, edu:0};
            if(houseCount==='3') return {tax:0.03, nt:0.002, edu:0};
        }
        return {tax:0.04, nt:0.002, edu:0.004};
    }
    document.getElementById('acqTaxForm').addEventListener('submit', function() {
        const itemType = document.querySelector('input[name="itemType"]:checked').value;
        const acqType = document.querySelector('input[name="acqType"]:checked').value;
        const houseCount = document.getElementById('houseCount').value;
        const over85 = document.querySelector('input[name="over85"]:checked').value;
        const acqPrice = parseInt(removeComma(document.getElementById('acqPrice').value)) || 0;
        const officialPrice = parseInt(removeComma(document.getElementById('officialPrice').value)) || 0;
        const rates = getTaxRates(itemType, acqType, houseCount, over85);
        const tax = Math.floor(acqPrice * rates.tax);
        const ntax = Math.floor(acqPrice * rates.nt);
        const edutax = Math.floor(acqPrice * rates.edu);
        const resultBox = document.getElementById('resultBox');
        resultBox.style.display = 'block';
        resultBox.innerHTML =
            `취득물건종류: <b>${itemType}</b><br>`+
            `취득구분: <b>${acqType}</b><br>`+
            `주택보유수: <b>${houseCount}</b><br>`+
            `85제곱 초과: <b>${over85==='yes'?'예':'아니오'}</b><br>`+
            `취득가액: <b>${addComma(acqPrice)}원</b><br>`+
            `공시지가: <b>${addComma(officialPrice)}원</b><br>`+
            `<hr style='margin:10px 0;'>취득세(예상): <b style='color:#17506b;font-size:1.2em;'>${addComma(tax)}원</b><br>`+
            `농어촌특별세(예상): <b>${addComma(ntax)}원</b><br>`+
            `교육세(예상): <b>${addComma(edutax)}원</b>`;
    });

    // 취득세율 안내 모달
    document.getElementById('showTaxRateBtn').onclick = function() {
        document.getElementById('taxRateModal').style.display = 'block';
    };
    document.getElementById('closeTaxRateModal').onclick = function() {
        document.getElementById('taxRateModal').style.display = 'none';
    };
    </script>
</body>
</html>
