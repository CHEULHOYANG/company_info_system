<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í‡´ì§ê¸ˆ ê³„ì‚°ê¸°</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
            padding: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-nav-btn {
            position: fixed;
            top: 1.25rem;
            right: 1.25rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.625rem 1.25rem;
            border-radius: 50px;
            font-size: 0.8125rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .main-nav-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .container {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 1.25rem;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            max-width: 1200px;
            width: 100%;
            padding: 2rem;
            margin: 0 auto;
        }

        h1 {
            color: #1e293b;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #0f172a, #334155);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        /* Top Tabs */
        .top-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 0.75rem;
            padding: 0.25rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(203, 213, 225, 0.3);
        }

        .top-tab {
            flex: 1;
            padding: 0.75rem;
            text-align: center;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            color: #64748b;
            transition: all 0.2s;
        }

        .top-tab.active {
            background: white;
            color: #3b82f6;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        /* Quick Calculation Tabs */
        .quick-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.25rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .quick-tab {
            padding: 0.625rem 1.25rem;
            border-radius: 50px;
            border: 1.5px solid rgba(59, 130, 246, 0.3);
            background: white;
            color: #64748b;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .quick-tab:hover,
        .quick-tab.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border-color: transparent;
            transform: translateY(-1px);
        }

        /* Grid Layout for Form Groups */
        .form-sections {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.25rem;
            margin-bottom: 1.25rem;
        }

        .form-group {
            background: rgba(248, 250, 252, 0.8);
            padding: 1.25rem;
            border-radius: 0.875rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(203, 213, 225, 0.3);
        }

        .form-group h3 {
            color: #334155;
            margin-bottom: 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            border-bottom: 2px solid rgba(148, 163, 184, 0.2);
            padding-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        /* Grid for Input Fields */
        .input-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.875rem;
        }

        .input-grid.single {
            grid-template-columns: 1fr;
        }

        .field-wrapper {
            display: flex;
            flex-direction: column;
        }

        label {
            display: block;
            margin-bottom: 0.375rem;
            font-weight: 500;
            color: #64748b;
            font-size: 0.75rem;
        }

        input,
        select {
            width: 100%;
            padding: 0.625rem 0.75rem;
            border: 1.5px solid rgba(203, 213, 225, 0.6);
            border-radius: 0.5rem;
            font-size: 0.8125rem;
            transition: all 0.2s ease;
            background: white;
            color: #1e293b;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .date-inputs {
            display: flex;
            gap: 0.5rem;
        }

        .date-inputs select {
            flex: 1;
        }

        .radio-group {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            cursor: pointer;
            margin-bottom: 0;
        }

        .radio-group input[type="radio"] {
            width: auto;
            cursor: pointer;
        }

        .help-text {
            font-size: 0.6875rem;
            color: #94a3b8;
            margin-top: 0.25rem;
        }

        .button-container {
            text-align: center;
            margin-bottom: 1.25rem;
        }

        .calc-btn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 0.875rem 2.5rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 14px rgba(59, 130, 246, 0.4);
            min-width: 200px;
        }

        .calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
        }

        .calc-btn:active {
            transform: translateY(0);
        }

        .result-container {
            background: linear-gradient(135deg, rgba(248, 250, 252, 0.9), rgba(241, 245, 249, 0.9));
            border-radius: 0.875rem;
            padding: 1.5rem;
            margin-top: 1.25rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(203, 213, 225, 0.3);
            display: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .form-sections {
                grid-template-columns: 1fr;
            }

            .input-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 1.5rem;
            }

            h1 {
                font-size: 1.25rem;
            }

            .quick-tabs {
                justify-content: flex-start;
            }
        }
    </style>
</head>

<body>
    <a href="/main" class="main-nav-btn">
        ğŸ  ë©”ì¸ìœ¼ë¡œ
    </a>

    <div class="container">
        <h1>ğŸ’° í‡´ì§ê¸ˆ ê³„ì‚°ê¸°</h1>

        <!-- Mode Selection Tabs -->
        <div class="top-tabs">
            <div class="top-tab" data-mode="employee">ì¼ë°˜ ì§ì›</div>
            <div class="top-tab active" data-mode="executive">ì„ì› / ëŒ€í‘œì´ì‚¬</div>
        </div>

        <!-- Quick Calculation Tabs -->
        <div class="quick-tabs">
            <button class="quick-tab" data-years="10" data-multiplier="1">10ë…„ ê·¼ë¬´</button>
            <button class="quick-tab" data-years="15" data-multiplier="1">15ë…„ ê·¼ë¬´</button>
            <button class="quick-tab" data-years="20" data-multiplier="1">20ë…„ ê·¼ë¬´</button>
            <button class="quick-tab" data-years="10" data-multiplier="2">10ë…„ 2ë°°ìˆ˜</button>
            <button class="quick-tab" data-years="10" data-multiplier="3">10ë…„ 3ë°°ìˆ˜</button>
            <button class="quick-tab" data-years="15" data-multiplier="2">15ë…„ 2ë°°ìˆ˜</button>
            <button class="quick-tab" data-years="15" data-multiplier="3">15ë…„ 3ë°°ìˆ˜</button>
        </div>

        <form id="retirementForm" onsubmit="return false;">
            <div class="form-sections">
                <!-- ê¸°ë³¸ ì •ë³´ -->
                <div class="form-group">
                    <h3>ğŸ“‹ ê·¼ë¬´ ê¸°ê°„</h3>
                    <div class="input-grid single">
                        <div class="field-wrapper">
                            <label for="joinDate">ì…ì‚¬ì¼</label>
                            <input type="date" id="joinDate" required>
                        </div>

                        <div class="field-wrapper">
                            <label for="leaveDate">í‡´ì‚¬ì¼</label>
                            <input type="date" id="leaveDate" required>
                        </div>
                    </div>
                </div>

                <!-- ê¸‰ì—¬ ì •ë³´ -->
                <div class="form-group">
                    <h3>ğŸ’µ ê¸‰ì—¬ ì •ë³´</h3>
                    <div class="input-grid single">
                        <div class="field-wrapper">
                            <label for="last1ySalary">í‡´ì§ ì§ì „ 1ë…„ê°„ ì´ ê¸‰ì—¬</label>
                            <input type="text" id="last1ySalary" placeholder="ì˜ˆ: 200,000,000" required>
                            <div class="help-text">í‡´ì§ê¸ˆ ê³„ì‚°ì˜ ê¸°ì¤€ì´ ë˜ëŠ” ê¸ˆì•¡</div>
                        </div>

                        <div class="field-wrapper" id="execSalaryField" style="display:none;">
                            <label for="last3ySalary">í‡´ì§ ì§ì „ 3ë…„ê°„ ì´ ê¸‰ì—¬</label>
                            <input type="text" id="last3ySalary" placeholder="ì˜ˆ: 600,000,000">
                            <div class="help-text">ì„ì›/ëŒ€í‘œì¼ ë•Œë§Œ ì…ë ¥</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-sections" id="execSection" style="display:none;">
                <!-- ì„ì› ì „ìš©: ê¸°ê°„ë³„ ë°°ìˆ˜ ì„¤ì • -->
                <div class="form-group" style="grid-column: span 2;">
                    <h3>âš¡ ì„ì› í‡´ì§ê¸ˆ ë°°ìˆ˜ ì„¤ì • (ê¸°ê°„ë³„ ë¶„ë¦¬)</h3>
                    <div
                        style="margin-bottom:1rem;padding:1rem;background:rgba(59,130,246,0.05);border-radius:0.5rem;border-left:3px solid #3b82f6;">
                        <p style="font-size:0.75rem;color:#1e40af;margin:0;">
                            <strong>ğŸ“… ì„ì› í‡´ì§ê¸ˆ í•œë„ ê·œì •:</strong><br>
                            2012ë…„, 2020ë…„ ì„¸ë²• ê°œì •ìœ¼ë¡œ ì¸í•´ ê·¼ë¬´ ê¸°ê°„ë³„ë¡œ ë‹¤ë¥¸ í•œë„ ë°°ìˆ˜ê°€ ì ìš©ë©ë‹ˆë‹¤.<br>
                            ì•„ë˜ í‘œì— ì •ê´€ì—ì„œ ì •í•œ ë°°ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”. (ì¼ë°˜ì ìœ¼ë¡œ 2011ë…„ ì´ì „ì€ ì •ê´€ë”°ë¦„, ê·¸ ì´í›„ëŠ” 2~3ë°°ìˆ˜)
                        </p>
                    </div>

                    <div style="overflow-x:auto;">
                        <table style="width:100%;border-collapse:collapse;font-size:0.8125rem;">
                            <thead>
                                <tr style="background:rgba(241,245,249,0.8);color:#475569;">
                                    <th style="padding:0.75rem;text-align:left;border-radius:0.5rem 0 0 0.5rem;">êµ¬ë¶„</th>
                                    <th style="padding:0.75rem;text-align:center;">ê¸°ê°„</th>
                                    <th style="padding:0.75rem;text-align:center;">ê·¼ë¬´ì¼ìˆ˜</th>
                                    <th style="padding:0.75rem;text-align:right;border-radius:0 0 0.5rem 0;">ì ìš© ë°°ìˆ˜</th>
                                </tr>
                            </thead>
                            <tbody id="periodTableBody">
                                <!-- JSë¡œ ë™ì  ìƒì„±ë¨ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="button-container">
                <button type="button" class="calc-btn" onclick="calculateRetirement()">ğŸ’° ê³„ì‚°í•˜ê¸°</button>
            </div>
        </form>

        <div id="retireResult" class="result-container"></div>
    </div>

    <script>
        // Tab Logic
        const topTabs = document.querySelectorAll('.top-tab');
        const execSection = document.getElementById('execSection');
        let currentMode = 'executive'; // 'employee' or 'executive'

        topTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                topTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentMode = tab.dataset.mode;
                updateUIState();
                calculateRetirement();
            });
        });

        function updateUIState() {
            const isExec = currentMode === 'executive';
            execSection.style.display = isExec ? 'grid' : 'none'; // Use grid for form-sections
            document.getElementById('execSalaryField').style.display = isExec ? 'flex' : 'none'; // flex for field-wrapper

            // Re-calculate split periods if executive
            if (isExec) {
                updatePeriodTable();
            }
        }

        // Quick Tab ê¸°ëŠ¥
        const quickTabs = document.querySelectorAll('.quick-tab');
        const today = new Date();
        const leaveDate = document.getElementById('leaveDate');
        const joinDate = document.getElementById('joinDate');

        // ì´ˆê¸° ë‚ ì§œ ì„¤ì •
        if (leaveDate) leaveDate.value = today.toISOString().split('T')[0];

        if (joinDate) {
            const tenYearsAgo = new Date(today.getFullYear() - 10, today.getMonth(), today.getDate());
            joinDate.value = tenYearsAgo.toISOString().split('T')[0];
        }

        quickTabs.forEach(tab => {
            tab.addEventListener('click', function () {
                quickTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');

                const years = parseInt(this.dataset.years);
                const multiplier = parseFloat(this.dataset.multiplier);

                // ì…ì‚¬ì¼ ìë™ ê³„ì‚°
                const leaveD = new Date(leaveDate.value);
                const joinD = new Date(leaveD.getFullYear() - years, leaveD.getMonth(), leaveD.getDate());
                joinDate.value = joinD.toISOString().split('T')[0];

                if (multiplier > 1) {
                    // Switch to Executive Tab automatically if multiplier > 1
                    topTabs[1].click();
                    // Set multipliers in table (simple approximation)
                    setTimeout(() => {
                        const m1 = document.getElementById('mul_pre2012');
                        const m2 = document.getElementById('mul_2012_2019');
                        const m3 = document.getElementById('mul_post2020');
                        if (m1) m1.value = 1;
                        if (m2) m2.value = multiplier;
                        if (m3) m3.value = multiplier;
                        calculateRetirement();
                    }, 50);
                } else {
                    topTabs[0].click();
                }
            });
        });

        if (leaveDate) {
            leaveDate.addEventListener('change', () => {
                if (currentMode === 'executive') updatePeriodTable();
            });
        }
        if (joinDate) {
            joinDate.addEventListener('change', () => {
                if (currentMode === 'executive') updatePeriodTable();
            });
        }

        function updatePeriodTable() {
            const periods = splitServicePeriod(joinDate.value, leaveDate.value);
            const tbody = document.getElementById('periodTableBody');

            tbody.innerHTML = `
            <tr style="border-bottom:1px solid #e2e8f0;">
                <td style="padding:0.75rem;">1êµ¬ê°„ (~2011.12.31)</td>
                <td style="padding:0.75rem;text-align:center;color:#64748b;font-size:0.75rem;">
                    \${periods.p1.start ? `\${ periods.p1.start } ~ \${ periods.p1.end } ` : '-'}
                </td>
                <td style="padding:0.75rem;text-align:center;">\${periods.p1.days}ì¼</td>
                <td style="padding:0.5rem 0.75rem;text-align:right;">
                    <input type="number" id="mul_pre2012" value="1.0" step="0.1" min="0" 
                        style="width:60px;padding:0.3rem;text-align:right;"> ë°°
                </td>
            </tr>
            <tr style="border-bottom:1px solid #e2e8f0;">
                <td style="padding:0.75rem;">2êµ¬ê°„ (2012.01.01~2019.12.31)</td>
                <td style="padding:0.75rem;text-align:center;color:#64748b;font-size:0.75rem;">
                    \${periods.p2.start ? `\${ periods.p2.start } ~ \${ periods.p2.end } ` : '-'}
                </td>
                <td style="padding:0.75rem;text-align:center;">\${periods.p2.days}ì¼</td>
                <td style="padding:0.5rem 0.75rem;text-align:right;">
                    <input type="number" id="mul_2012_2019" value="2.0" step="0.1" min="0" 
                        style="width:60px;padding:0.3rem;text-align:right;"> ë°°
                </td>
            </tr>
            <tr>
                <td style="padding:0.75rem;">3êµ¬ê°„ (2020.01.01~)</td>
                <td style="padding:0.75rem;text-align:center;color:#64748b;font-size:0.75rem;">
                    \${periods.p3.start ? `\${ periods.p3.start } ~ \${ periods.p3.end } ` : '-'}
                </td>
                <td style="padding:0.75rem;text-align:center;">\${periods.p3.days}ì¼</td>
                <td style="padding:0.5rem 0.75rem;text-align:right;">
                    <input type="number" id="mul_post2020" value="3.0" step="0.1" min="0" 
                        style="width:60px;padding:0.3rem;text-align:right;"> ë°°
                </td>
            </tr>
            `;

            // Add input listeners
            ['mul_pre2012', 'mul_2012_2019', 'mul_post2020'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.addEventListener('input', calculateRetirement);
            });

            calculateRetirement();
        }

        function splitServicePeriod(startStr, endStr) {
            const start = new Date(startStr);
            const end = new Date(endStr);

            if (start > end) return { p1: { days: 0 }, p2: { days: 0 }, p3: { days: 0 } };

            // Boundaries
            const b1 = new Date('2011-12-31');
            const b2_start = new Date('2012-01-01');
            const b2_end = new Date('2019-12-31');
            const b3_start = new Date('2020-01-01');

            function getOverlapDays(s, e, rS, rE) {
                const actS = s > rS ? s : rS;
                const actE = e < rE ? e : rE;
                if (actS > actE) return 0;
                return Math.floor((actE - actS) / (1000 * 60 * 60 * 24)) + 1;
            }

            const p1Days = getOverlapDays(start, end, new Date('1900-01-01'), b1);
            const p2Days = getOverlapDays(start, end, b2_start, b2_end);
            const p3Days = getOverlapDays(start, end, b3_start, new Date('2099-12-31'));

            return {
                p1: {
                    days: p1Days,
                    start: p1Days > 0 ? (start < b1 ? startStr : '2012ì´ì „') : null,
                    end: p1Days > 0 ? (end < b1 ? endStr : '2011-12-31') : null
                },
                p2: {
                    days: p2Days,
                    start: p2Days > 0 ? (start > b2_start ? startStr : '2012-01-01') : null,
                    end: p2Days > 0 ? (end < b2_end ? endStr : '2019-12-31') : null
                },
                p3: {
                    days: p3Days,
                    start: p3Days > 0 ? (start > b3_start ? startStr : '2020-01-01') : null,
                    end: p3Days > 0 ? endStr : null
                }
            };
        }

        // ì½¤ë§ˆ ì²˜ë¦¬
        function addComma(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        function removeComma(x) {
            return x.replace(/,/g, "");
        }

        function setCommaInput(id) {
            const el = document.getElementById(id);
            if (!el) return;
            el.addEventListener('input', function () {
                let val = el.value.replace(/[^\d]/g, '');
                el.value = val ? addComma(val) : '';
                calculateRetirement(); // Recalculate on input
            });
        }

        setCommaInput('last1ySalary');
        setCommaInput('last3ySalary');

        // í‡´ì§ê¸ˆ ê³„ì‚°
        function calculateRetirement() {
            const join = new Date(joinDate.value);
            const leave = new Date(leaveDate.value);
            const last1y = parseInt(removeComma(document.getElementById('last1ySalary').value)) || 0;
            const last3y = parseInt(removeComma(document.getElementById('last3ySalary').value)) || 0;
            const isExec = currentMode === 'executive';

            // ì¬ì§ì¼ìˆ˜ ê³„ì‚°
            const days = Math.floor((leave - join) / (1000 * 60 * 60 * 24)); // Total diff
            if (days < 0) return;
            const years = days / 365;

            // í‰ê· ì„ê¸ˆ ê³„ì‚° 
            let avgMonthlySalary = 0;
            if (isExec && last3y > 0) {
                avgMonthlySalary = last3y / 36; // 3ë…„ ì´ê¸‰ì—¬ / 36ê°œì›” (ë‹¨ìˆœ)
            } else {
                avgMonthlySalary = last1y / 12; // 1ë…„ ì´ê¸‰ì—¬ / 12ê°œì›”
            }

            // ì¼í‰ê· ì„ê¸ˆ (í†µìƒ 30ì¼ë¶„)
            const dailyWage = avgMonthlySalary / 30;

            let totalRetirePay = 0;
            let displayDetails = [];

            if (isExec) {
                // ì„ì› ê³„ì‚° (êµ¬ê°„ë³„ ë°°ìˆ˜ ì ìš©)
                const mul1 = parseFloat(document.getElementById('mul_pre2012')?.value || 1);
                const mul2 = parseFloat(document.getElementById('mul_2012_2019')?.value || 2);
                const mul3 = parseFloat(document.getElementById('mul_post2020')?.value || 3);

                const periods = splitServicePeriod(joinDate.value, leaveDate.value);

                // P1 Pay
                const p1Years = periods.p1.days / 365;
                const p1Pay = avgMonthlySalary * p1Years * mul1;

                // P2 Pay
                const p2Years = periods.p2.days / 365;
                const p2Pay = avgMonthlySalary * p2Years * mul2;

                // P3 Pay
                const p3Years = periods.p3.days / 365;
                const p3Pay = avgMonthlySalary * p3Years * mul3;

                totalRetirePay = p1Pay + p2Pay + p3Pay;

                displayDetails = [
                    { label: '1êµ¬ê°„ (~11ë…„)', amount: p1Pay, info: `\${periods.p1.days}ì¼ x \${mul1}ë°°` },
                    { label: '2êµ¬ê°„ (12~19ë…„)', amount: p2Pay, info: `\${periods.p2.days}ì¼ x \${mul2}ë°°` },
                    { label: '3êµ¬ê°„ (20ë…„~)', amount: p3Pay, info: `\${periods.p3.days}ì¼ x \${mul3}ë°°` }
                ];
            } else {
                // ì¼ë°˜ ì§ì› (ë²•ì •í‡´ì§ê¸ˆ: 1ë…„ì— 30ì¼ë¶„ í‰ê· ì„ê¸ˆ -> ì›”í‰ê· ì„ê¸ˆ * ê·¼ì†ë…„ìˆ˜)
                totalRetirePay = avgMonthlySalary * years;
            }

            displayResult(years, avgMonthlySalary, totalRetirePay, isExec, displayDetails);
        }

        function displayResult(years, avgSalary, totalRetirePay, isExec, details) {
            const resultDiv = document.getElementById('retireResult');
            const formatCurrency = (num) => Math.round(num).toLocaleString('ko-KR') + ' ì›';

            let execDetailsHtml = '';
            if (isExec) {
                const rows = details.map(d => `
                    <div style="display:flex;justify-content:space-between;align-items:center;font-size:0.8125rem;">
                        <span>\${d.label} <span style="font-size:0.75rem;color:#94a3b8;">(\${d.info})</span></span>
                        <span style="font-weight:600;color:#334155;">\${formatCurrency(d.amount)}</span>
                    </div>
                `).join('');

                execDetailsHtml = `
            <div style="background:rgba(241,245,249,0.8);border-radius:0.625rem;padding:1rem;margin-bottom:1rem;border:1px solid rgba(203,213,225,0.3);">
                <h5 style="font-size:0.75rem;color:#64748b;margin-bottom:0.75rem;font-weight:600;">êµ¬ê°„ë³„ ê³„ì‚° ë‚´ì—­</h5>
                <div style="display:grid;gap:0.5rem;">
                    \${rows}
                </div>
                <div style="height:1px;background:#cbd5e1;margin:0.75rem 0;"></div>
                <div style="display:flex;justify-content:space-between;align-items:center;">
                    <span style="font-size:0.875rem;font-weight:700;">í•©ê³„</span>
                    <span style="font-size:1rem;font-weight:700;color:#3b82f6;">\${formatCurrency(totalRetirePay)}</span>
                </div>
            </div>`;
            }

            const tipHtml = isExec ?
                'ì„ì› í‡´ì§ê¸ˆì€ <strong>ìµœê·¼ 3ë…„ í‰ê· ê¸‰ì—¬ Ã— ê·¼ì†ì—°ìˆ˜ Ã— ì •ê´€ ë°°ìˆ˜</strong>ë¡œ ê³„ì‚°ë˜ë©°, 2012ë…„/2020ë…„ ê°œì •ì— ë”°ë¼ ê¸°ê°„ë³„ í•œë„ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤.' :
                'ì¼ë°˜ ì§ì›ì€ <strong>1ë…„ ê·¼ë¬´ ì‹œ 30ì¼ë¶„ì˜ í‰ê· ì„ê¸ˆ</strong>(ìµœê·¼ 3ê°œì›” ê¸°ì¤€ ì‚°ì •, ì—¬ê¸°ì„  ê°„í¸í•˜ê²Œ ì—°ê°„ì´ì•¡/12)ì´ ì§€ê¸‰ë©ë‹ˆë‹¤.';

            resultDiv.innerHTML = `
            <h4 style="color:#1e293b;margin-bottom:1rem;font-size:0.9375rem;font-weight:600;display:flex;align-items:center;gap:0.5rem;">
                <span style="color:#3b82f6;">ğŸ“Š</span> í‡´ì§ê¸ˆ ê³„ì‚° ê²°ê³¼
            </h4>
            <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:0.75rem;margin-bottom:1rem;">
                <div style="display:flex;flex-direction:column;padding:0.875rem;background:white;border-radius:0.5rem;border:1px solid rgba(203,213,225,0.3);">
                    <span style="font-size:0.6875rem;color:#64748b;margin-bottom:0.25rem;">ì¬ì§ê¸°ê°„</span>
                    <span style="font-size:0.8125rem;font-weight:600;color:#1e293b;">\${years.toFixed(2)} ë…„</span>
                </div>
                <div style="display:flex;flex-direction:column;padding:0.875rem;background:white;border-radius:0.5rem;border:1px solid rgba(203,213,225,0.3);">
                    <span style="font-size:0.6875rem;color:#64748b;margin-bottom:0.25rem;">ì›” í‰ê·  ê¸‰ì—¬</span>
                    <span style="font-size:0.8125rem;font-weight:600;color:#1e293b;">\${formatCurrency(avgSalary)}</span>
                </div>
            </div>

            \${execDetailsHtml}

            <div style="display:flex;justify-content:space-between;align-items:center;padding:1rem 1.25rem;background:linear-gradient(135deg,#10b981,#059669);border-radius:0.625rem;color:white;box-shadow:0 4px 15px rgba(16,185,129,0.3);">
                <span style="font-weight:600;font-size:0.875rem;">ì˜ˆìƒ í‡´ì§ê¸ˆ (ì§€ê¸‰ì•¡)</span>
                <span style="font-weight:700;font-size:1.25rem;">\${formatCurrency(totalRetirePay)}</span>
            </div>

            <div style="margin-top:1rem;padding:0.75rem;background:rgba(59,130,246,0.1);border-radius:0.5rem;border-left:3px solid #3b82f6;">
                <p style="font-size:0.75rem;color:#1e40af;margin:0;">
                    <strong>ğŸ’¡ Tip:</strong> \${tipHtml}
                </p>
            </div>
            `;

            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        document.getElementById('retirementForm').addEventListener('submit', function (e) {
            e.preventDefault();
            calculateRetirement();
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        window.addEventListener('load', function () {
            updateUIState(); // Ensure UI matches the default mode
            calculateRetirement();
        });
    </script>
</body>

</html>